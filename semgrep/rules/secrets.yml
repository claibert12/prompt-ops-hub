# Semgrep rules for detecting hardcoded secrets and sensitive information
# These rules help prevent accidental exposure of credentials and secrets

rules:
  - id: hardcoded-password
    pattern: password\s*=\s*['"][^'"]+['"]
    message: "Hardcoded password detected. Use environment variables or secure storage."
    severity: HIGH
    languages: [python]
    metadata:
      category: security
      subcategory: secrets

  - id: hardcoded-api-key
    pattern: api_key\s*=\s*['"][^'"]+['"]
    message: "Hardcoded API key detected. Use environment variables or secure storage."
    severity: HIGH
    languages: [python]
    metadata:
      category: security
      subcategory: secrets

  - id: hardcoded-secret
    pattern: secret\s*=\s*['"][^'"]+['"]
    message: "Hardcoded secret detected. Use environment variables or secure storage."
    severity: HIGH
    languages: [python]
    metadata:
      category: security
      subcategory: secrets

  - id: hardcoded-token
    pattern: token\s*=\s*['"][^'"]+['"]
    message: "Hardcoded token detected. Use environment variables or secure storage."
    severity: HIGH
    languages: [python]
    metadata:
      category: security
      subcategory: secrets

  - id: hardcoded-credential
    pattern: credential\s*=\s*['"][^'"]+['"]
    message: "Hardcoded credential detected. Use environment variables or secure storage."
    severity: HIGH
    languages: [python]
    metadata:
      category: security
      subcategory: secrets

  - id: aws-access-key
    pattern: AKIA[0-9A-Z]{16}
    message: "AWS access key ID detected. Use IAM roles or environment variables."
    severity: HIGH
    languages: [python]
    metadata:
      category: security
      subcategory: aws

  - id: private-key-indicator
    pattern: -----BEGIN\s+(RSA\s+)?PRIVATE\s+KEY-----
    message: "Private key detected. Use secure key management."
    severity: HIGH
    languages: [python]
    metadata:
      category: security
      subcategory: keys 